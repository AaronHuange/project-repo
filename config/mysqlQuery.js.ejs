const mysql = require('mysql');
const config = {
  host: '<%- SQL_HOST %>',
  port: '<%- SQL_PORT %>',
  user: '<%- SQL_USER %>',
  password: '<%- SQL_PASSWORD %>',
  database: '<%- SQL_DATABASE %>',
};
console.log('创建mysql连接池：全局只执行一次');
let pool = mysql.createPool(config);
module.exports = (sql, paramsArray, callback) => {
  pool.getConnection((err, connection) => { // 获取连接的回调
    if (err) {
      callback(err, connection);
      return;
    }
    connection.query(sql, paramsArray, (queryErr, result) => {
      callback(queryErr, result);
    });
    connection.release(); // 释放连接到连接池中
  });
};